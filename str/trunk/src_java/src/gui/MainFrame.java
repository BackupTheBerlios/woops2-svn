/*
 * MainFrame.java
 *
 * Created on 12 mars 2007, 17:29
 */

package gui;

import gui.sprite.SpriteFactory;

import java.util.ArrayList;

import model.Bus;

import common.Constante;

import controler.ClientControler;

/**
 * 
 * @author garwind
 */
public class MainFrame extends javax.swing.JFrame {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	private static MainFrame mainFrame;

	public static MainFrame getInstance() {
		if (mainFrame == null)
			mainFrame = new MainFrame();
		return mainFrame;
	}

	/** Creates new form MainFrame */
	private MainFrame() {
		initComponents();

	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	// <editor-fold defaultstate="collapsed" desc=" Generated Code
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">                          
    private void initComponents() {
        buttonsPanel = new javax.swing.JPanel();
        connectButton = new javax.swing.JButton();
        exitButton = new javax.swing.JButton();
        tabbedPane = new javax.swing.JTabbedPane();
        controlePanel = new javax.swing.JPanel();
        busTableScrollPane = new javax.swing.JScrollPane();
        busTable = new javax.swing.JTable();
        startBusButton = new javax.swing.JButton();
        breakBusButton = new javax.swing.JButton();
        busListLabel = new javax.swing.JLabel();
        accelerateBusButton = new javax.swing.JButton();
        decelerateBusButton = new javax.swing.JToggleButton();
        incidentBusButton = new javax.swing.JButton();
        agressionBusButton1 = new javax.swing.JButton();
        busStopPanel = new javax.swing.JPanel();
        busStopTableScrollPane = new javax.swing.JScrollPane();
        busStopTable = new javax.swing.JTable();
        busStopListLabel = new javax.swing.JLabel();
        creationPanel = new javax.swing.JPanel();
        creationPanel1 = new javax.swing.JPanel();
        createBusLabel = new javax.swing.JLabel();
        busIdInoutText = new javax.swing.JTextField();
        busLineLabel = new javax.swing.JLabel();
        busLinesComboBox = new javax.swing.JComboBox();
        creationPanel2 = new javax.swing.JPanel();
        createBusButton = new javax.swing.JButton();
        messagePanel = new javax.swing.JPanel();
        messageScrollPane = new javax.swing.JScrollPane();
        messagesArea = new javax.swing.JTextArea();
        messagesLabel = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("ISI Bus Navigator");
        setName("ISI Bus Navigator");
        setResizable(false);
        connectButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/connect32x32.jpg")));
        connectButton.setText("Connexion");
        connectButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                connectButtonActionPerformed(evt);
            }
        });

        exitButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/exit.gif")));
        exitButton.setText("Quitter");
        exitButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitButtonActionPerformed(evt);
            }
        });

        org.jdesktop.layout.GroupLayout buttonsPanelLayout = new org.jdesktop.layout.GroupLayout(buttonsPanel);
        buttonsPanel.setLayout(buttonsPanelLayout);
        buttonsPanelLayout.setHorizontalGroup(
            buttonsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(buttonsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(connectButton)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(exitButton)
                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        buttonsPanelLayout.setVerticalGroup(
            buttonsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(buttonsPanelLayout.createSequentialGroup()
                .add(21, 21, 21)
                .add(buttonsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(connectButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 37, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(exitButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 37, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(24, Short.MAX_VALUE))
        );
        /*
        busTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Bus", "Ligne", "Démarré", "X", "Y"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Boolean.class, java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });*/
        busTableScrollPane.setViewportView(busTable);
        

        startBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/start.png")));
        startBusButton.setText("D\u00e9marrer un Bus");
        startBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                startBusButtonActionPerformed(evt);
            }
        });

        breakBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/stop.png")));
        breakBusButton.setText("Simuler un accident");
        breakBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                breakBusButtonActionPerformed(evt);
            }
        });

        busListLabel.setText("Liste des bus :");

        accelerateBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/accelerate.png")));
        accelerateBusButton.setText("Acc\u00e9l\u00e9rer un Bus");
        accelerateBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                accelerateBusButtonActionPerformed(evt);
            }
        });

        decelerateBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/decelerate.png")));
        decelerateBusButton.setText("Ralentir un Bus");
        decelerateBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                decelerateBusButtonActionPerformed(evt);
            }
        });

        incidentBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/incident.png")));
        incidentBusButton.setText("Simuler une panne");
        incidentBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                incidentBusButtonActionPerformed(evt);
            }
        });

        agressionBusButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/agression.png")));
        agressionBusButton1.setText("SImuler une agression");
        agressionBusButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                agressionBusButton1ActionPerformed(evt);
            }
        });

        org.jdesktop.layout.GroupLayout controlePanelLayout = new org.jdesktop.layout.GroupLayout(controlePanel);
        controlePanel.setLayout(controlePanelLayout);
        controlePanelLayout.setHorizontalGroup(
            controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(controlePanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(busListLabel)
                    .add(busTableScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 381, Short.MAX_VALUE))
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(org.jdesktop.layout.GroupLayout.TRAILING, startBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 236, Short.MAX_VALUE)
                    .add(org.jdesktop.layout.GroupLayout.TRAILING, breakBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 236, Short.MAX_VALUE)
                    .add(org.jdesktop.layout.GroupLayout.TRAILING, incidentBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 236, Short.MAX_VALUE)
                    .add(decelerateBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 236, Short.MAX_VALUE)
                    .add(org.jdesktop.layout.GroupLayout.TRAILING, accelerateBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 236, Short.MAX_VALUE)
                    .add(agressionBusButton1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 236, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        controlePanelLayout.setVerticalGroup(
            controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(org.jdesktop.layout.GroupLayout.TRAILING, controlePanelLayout.createSequentialGroup()
                .add(controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                    .add(org.jdesktop.layout.GroupLayout.LEADING, controlePanelLayout.createSequentialGroup()
                        .add(12, 12, 12)
                        .add(controlePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                            .add(busListLabel)
                            .add(startBusButton))
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(breakBusButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 48, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(incidentBusButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(agressionBusButton1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .add(accelerateBusButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 49, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(decelerateBusButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 49, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                    .add(controlePanelLayout.createSequentialGroup()
                        .add(33, 33, 33)
                        .add(busTableScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)))
                .add(12, 12, 12))
        );
        tabbedPane.addTab("Gestion des bus", controlePanel);
        /*
        busStopTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "N° Arret", "Informations"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });*/
        busStopTableScrollPane.setViewportView(busStopTable);

        busStopListLabel.setText("Liste des arr\u00e9ts :");

        org.jdesktop.layout.GroupLayout busStopPanelLayout = new org.jdesktop.layout.GroupLayout(busStopPanel);
        busStopPanel.setLayout(busStopPanelLayout);
        busStopPanelLayout.setHorizontalGroup(
            busStopPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(busStopPanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(busStopPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(busStopTableScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 623, Short.MAX_VALUE)
                    .add(busStopListLabel))
                .addContainerGap())
        );
        busStopPanelLayout.setVerticalGroup(
            busStopPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(busStopPanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(busStopListLabel)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(busStopTableScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
                .addContainerGap())
        );
        tabbedPane.addTab("Informations des Arr\u00e9ts Bus", busStopPanel);

        createBusLabel.setText("Identifiant du bus : ");

        busLineLabel.setText("Liste des lignes de bus : ");

        busLinesComboBox.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "12", "24" }));

        org.jdesktop.layout.GroupLayout creationPanel1Layout = new org.jdesktop.layout.GroupLayout(creationPanel1);
        creationPanel1.setLayout(creationPanel1Layout);
        creationPanel1Layout.setHorizontalGroup(
            creationPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .add(creationPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(creationPanel1Layout.createSequentialGroup()
                        .add(createBusLabel)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(busIdInoutText, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 33, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                    .add(creationPanel1Layout.createSequentialGroup()
                        .add(busLineLabel)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(busLinesComboBox, 0, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(145, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
        );
        creationPanel1Layout.setVerticalGroup(
            creationPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .add(creationPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(createBusLabel)
                    .add(busIdInoutText, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 19, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(creationPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(busLineLabel)
                    .add(busLinesComboBox, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(33, Short.MAX_VALUE))
        );

        createBusButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/images/add.png")));
        createBusButton.setText("Ajouter un Bus");
        createBusButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                createBusButtonActionPerformed(evt);
            }
        });

        org.jdesktop.layout.GroupLayout creationPanel2Layout = new org.jdesktop.layout.GroupLayout(creationPanel2);
        creationPanel2.setLayout(creationPanel2Layout);
        creationPanel2Layout.setHorizontalGroup(
            creationPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .add(createBusButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 190, Short.MAX_VALUE)
                .addContainerGap())
        );
        creationPanel2Layout.setVerticalGroup(
            creationPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanel2Layout.createSequentialGroup()
                .add(21, 21, 21)
                .add(createBusButton)
                .addContainerGap(32, Short.MAX_VALUE))
        );

        org.jdesktop.layout.GroupLayout creationPanelLayout = new org.jdesktop.layout.GroupLayout(creationPanel);
        creationPanel.setLayout(creationPanelLayout);
        creationPanelLayout.setHorizontalGroup(
            creationPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(creationPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(creationPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        creationPanelLayout.setVerticalGroup(
            creationPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(creationPanelLayout.createSequentialGroup()
                .addContainerGap()
                .add(creationPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(creationPanelLayout.createSequentialGroup()
                        .add(creationPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap())
                    .add(creationPanelLayout.createSequentialGroup()
                        .add(creationPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap(234, Short.MAX_VALUE))))
        );
        tabbedPane.addTab("Ajout de bus", creationPanel);

        messagesArea.setColumns(20);
        messagesArea.setRows(5);
        messageScrollPane.setViewportView(messagesArea);

        messagesLabel.setText("Messages prioritaires :");

        org.jdesktop.layout.GroupLayout messagePanelLayout = new org.jdesktop.layout.GroupLayout(messagePanel);
        messagePanel.setLayout(messagePanelLayout);
        messagePanelLayout.setHorizontalGroup(
            messagePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(messagePanelLayout.createSequentialGroup()
                .add(messagesLabel)
                .addContainerGap(206, Short.MAX_VALUE))
            .add(messageScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 346, Short.MAX_VALUE)
        );
        messagePanelLayout.setVerticalGroup(
            messagePanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(messagePanelLayout.createSequentialGroup()
                .add(messagesLabel)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(messageScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 49, Short.MAX_VALUE)
                .addContainerGap())
        );

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .addContainerGap()
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(layout.createSequentialGroup()
                        .add(buttonsPanel, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                        .add(messagePanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .add(tabbedPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 652, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .add(tabbedPane)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
                    .add(messagePanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .add(buttonsPanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-686)/2, (screenSize.height-508)/2, 686, 508);
    }// </editor-fold>                        

    private void agressionBusButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                                    
    	int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.AGRESSION, ""+busId, "null", 0, 0);
		Bus b = ClientControler.getInstance().getBus().get(busId);
		b.setState(Constante.AGRESSION_STATE);
		b.getRepresentation().setSprite(SpriteFactory.getInstance().getSprite("resources/images/dot_b_agression.png"));
    }                                                   

    private void exitButtonActionPerformed(java.awt.event.ActionEvent evt) {                                           
    	System.out.println("exiting ...");
		System.exit(0);
    }                                          

	private void decelerateBusButtonActionPerformed(
			java.awt.event.ActionEvent evt) {// GEN-FIRST:event_decelerateBusButtonActionPerformed
		int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.DEC_BUS,
				"" + busId, "null", 0, 0);

	}// GEN-LAST:event_decelerateBusButtonActionPerformed

	private void accelerateBusButtonActionPerformed(
			java.awt.event.ActionEvent evt) {// GEN-FIRST:event_accelerateBusButtonActionPerformed
		int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.ACC_BUS,	"" + busId, "null", 0, 0);
	}// GEN-LAST:event_accelerateBusButtonActionPerformed

	private void incidentBusButtonActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_incidentBusButtonActionPerformed
		int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.BREAKDOWN, ""+busId, "null", 0, 0);
		Bus b = ClientControler.getInstance().getBus().get(busId);
		b.setState(Constante.BREAKDOWN_STATE);
		b.getRepresentation().setSprite(SpriteFactory.getInstance().getSprite("resources/images/dot_b_panne.png"));
	}// GEN-LAST:event_incidentBusButtonActionPerformed

	private void breakBusButtonActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_stopBusButtonActionPerformed
		int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.ACCIDENT, ""+busId, "null", 0, 0);
		Bus b = ClientControler.getInstance().getBus().get(busId);
		b.setState(Constante.ACCIDENT_STATE);
		b.getRepresentation().setSprite(SpriteFactory.getInstance().getSprite("resources/images/dot_b_break.png"));
	}// GEN-LAST:event_breakBusButtonActionPerformed

	private void startBusButtonActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_startBusButtonActionPerformed
		int rownb = this.busTable.getSelectedRow();
		int busId = (Integer) ((BusTableModel) this.busTable.getModel())
				.getValueAt(rownb, 0);
		ClientControler.getInstance().sendCreateCommand(Constante.START_BUS,
				"" + busId, "null", 0, 0);
		this.refreshBusTable();
	}// GEN-LAST:event_startBusButtonActionPerformed

	private void createBusButtonActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_createBusButtonActionPerformed
		ClientControler.getInstance().sendCreateCommand(Constante.BUS,
				this.busIdInoutText.getText().trim(),
				(String) this.busLinesComboBox.getSelectedItem(), 104, 37);
	}// GEN-LAST:event_createBusButtonActionPerformed

	private void connectButtonActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_connectButtonActionPerformed
		ClientControler.getInstance().initialisation();
		this.connectButton.setEnabled(false);
		this.busTableModel = new BusTableModel(ClientControler.getInstance()
				.getBus());
		this.busStopTableModel = new InformationTableModel();
		busTable.setModel(busTableModel);
		busStopTable.setModel(busStopTableModel);
	}// GEN-LAST:event_connectButtonActionPerformed
	
	public void refreshBusTable() {
		this.busTableModel.refreshModel(ClientControler.getInstance().getBus());
		this.busTable.updateUI();
	}

	public void refreshInformation() {
		this.busStopTableModel.refreshModel();
		ClientControler.getInstance().getInformationsQueue().clear();
		this.busStopTable.updateUI();
	}

    // Variables declaration - do not modify                     
    private javax.swing.JButton accelerateBusButton;
    private javax.swing.JButton agressionBusButton1;
    private javax.swing.JButton breakBusButton;
    private javax.swing.JTextField busIdInoutText;
    private javax.swing.JLabel busLineLabel;
    private javax.swing.JComboBox busLinesComboBox;
    private javax.swing.JLabel busListLabel;
    private javax.swing.JLabel busStopListLabel;
    private javax.swing.JPanel busStopPanel;
    private javax.swing.JTable busStopTable;
    private javax.swing.JScrollPane busStopTableScrollPane;
    private javax.swing.JTable busTable;
    private javax.swing.JScrollPane busTableScrollPane;
    private javax.swing.JPanel buttonsPanel;
    private javax.swing.JButton connectButton;
    private javax.swing.JPanel controlePanel;
    private javax.swing.JButton createBusButton;
    private javax.swing.JLabel createBusLabel;
    private javax.swing.JPanel creationPanel;
    private javax.swing.JPanel creationPanel1;
    private javax.swing.JPanel creationPanel2;
    private javax.swing.JToggleButton decelerateBusButton;
    private javax.swing.JButton exitButton;
    private javax.swing.JButton incidentBusButton;
    private javax.swing.JPanel messagePanel;
    private javax.swing.JScrollPane messageScrollPane;
    private javax.swing.JTextArea messagesArea;
    private javax.swing.JLabel messagesLabel;
    private javax.swing.JButton startBusButton;
    private javax.swing.JTabbedPane tabbedPane;
    private BusTableModel busTableModel;
	private InformationTableModel busStopTableModel;

	public void refreshPriorityMessages() {
		ArrayList<String> listeMsg = new ArrayList<String>(); 
		listeMsg.addAll(ClientControler.getInstance().getPriorityMessageQueue());
		for (String s : listeMsg){
			this.messagesArea.setText(this.messagesArea.getText()+"\n"+s);
		}
		ClientControler.getInstance().getPriorityMessageQueue().clear();
	}
    
    // End of variables declaration                   

}
